rules:
  - id: jackson_deserialization
    patterns:
      - pattern-either:
          - pattern: |
              import com.fasterxml.jackson.databind.ObjectMapper;
              ...
              $Z.enableDefaultTyping();
    message: >-
      The app uses jackson deserialization library. Deserialization of untrusted
      input can result in arbitrary code execution. Consider using HMACs to sign
      the data stream to make sure it is not tampered with, or consider only 
      transmitting object fields and populating a new object.
    languages:
      - java
    severity: ERROR
    metadata:
      cwe: cwe-502
      cves:
        - CVE-2019-12799
        - CVE-2015-8103
        - CVE-2015-4852
        - CVE-2013-1465
        - CVE-2012-3527
        - CVE-2012-0911
        - CVE-2012-0911
        - CVE-2011-2520
        - CVE-2012-4406
        - CVE-2003-0791
      owasp-mobile: m1
      masvs: platform-8
      reference: >-
        https://github.com/MobSF/owasp-mstg/blob/master/Document/0x05h-Testing-Platform-Interaction.md#testing-object-persistence-mstg-platform-8
